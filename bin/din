#!/usr/bin/env python

import sys
import os
import re

try:
    import din
except ImportError:
    sys.path.append(os.path.join(os.path.dirname(__file__), ".."))
    import din

def configure(engine):
    filename = os.path.join(os.getenv("HOME"), ".dinrc")
    with open(filename, "r") as stream:
        source = stream.read()

    context = dict(din.BUILTINS)
    context["commands"] = engine.commands
    co = compile(source, filename, "exec")
    exec co in context

def main():
    engine = din.Engine()
    configure(engine)

    din.run(engine)

if __name__ == "__main__":
    main()

